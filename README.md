# 环境
- 推荐node version：v16.13.1  > 16
- 包管理器：npm@8.16.0
- 建议浏览器：最新版chrome  或Microsoft Edge

# 启动方式
- 安装依赖 npm install
- 启动 npm run dev，会自动在默认浏览器打开

----------------------------------------------------------------------

# 需求分析
- 网页的方式呈现（web）
- 查询账单
  - 月份筛选、账单分类筛选
- 账单统计
  - 所选月份的收入与支出总金额
  - 支出金额统计（排序）
- 添加账单

# 功能设计
- dashboard
  - 筛选条件：账单月份，为空时则为全部，根据所提供数据设置默认值为2019-12
  - 收入与支出对比 饼图
  - 收入统计 柱状图 x:账单分类 y:合计金额
  - 支出统计 柱状图 x:账单分类 y:合计金额
- 记账本
  - 筛选条件：
    - 账单月份，为空时则为全部，根据所提供数据设置默认值为2019-12
    - 账单分类，为空时则为全部
  - 收入支出统计：仅账单月份条件生效
    - 当所选月份为空时，只展示合计收入和累计支出
    - 当所选月份不为空时，展示 合计收入和累计支出按照账单分类聚合后按照合计金额排序的表格
  - 账单详情
    - 筛选条件均生效
    - 展示账单时间、账单类型、账单分类、账单金额
  - 记账
    - 可新增记账，账单分类可以为空，账单分类为空时其他地方展示为'--'

# 技术选型
- 确定为web应用，Web端选择用Vue 3 + Element Plus + TypeScript + Vite + Pinia + echarts
  - 简单集成 eslint、stylelint
  - 实现 动态菜单、面包屑、标签页、全屏、暗黑模式等基础 layout
- Server端原考虑用java spring boot或.net core
  - 由于功能较少，数据来源也只是csv文件，因此选择使用nodejs来做简单的类似mock server的功能
  - 引入较大的nodejs server库或者mock库过于笨重，因此选择 express 来简单实现下服务端相关功能，经过简单修改也可以单独启动server 方便部署


# hot reload 会导致 billServer 重新 startServer，此时端口已经被占用，会导致程序cash
首先考虑应当判断服务状态后再去listen。由于express没有相关api，因此使用express().listen(port)返回的 http.Server 的实例
由于 hot reload 会重新初始化 BillServer，因此考虑将该实例放入静态变量中，但是实际上BillServer类也会发生变化，
因此将该实例 存放到 node 进程的 global 当中

# 数据存储
考虑到数据来源时csv文件，因此将数据载入到nodejs 内存当中，新增记账的数据也仅存到内存当中，未做回写。写入文件直接采用 writeFile 来进行即可。